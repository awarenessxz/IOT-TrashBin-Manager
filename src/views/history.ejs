<!DOCTYPE html>
<html>
	<head>
		<!-- Page Title -->
		<title>Data Received from IoT Sensors</title>
		<link rel='stylesheet' href='/stylesheets/style.css' />
		<link rel='stylesheet' href='/stylesheets/label_template.css' />
		<link rel='stylesheet' href='/stylesheets/mdi/css/materialdesignicons.css' />

		<!-- CSS for Styling -->
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

		<!-- JavaScript for Interactivity -->
		<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
	</head>
	<body class="header-fixed">
		<div class="page-body">
			<% include partials/nav.ejs %>
			<% include partials/sidebar.ejs %>
			<div class="page-content-wrapper">
				<div class="content-viewport">
					<div class="row">
						<div class="col-12 py-5">
							<h1><%= title%></h1>
							<table class="table">
								<thead>
									<tr>
										<th scope="col">TOPIC</th>
										<th scope="col">DISTANCE</th>
										<th scope="col">DATETIME SUBMITTED</th>
									</tr>
								</thead>
								<tbody id="data2">
									<% for(var i=0; i<data.length; i++) { %>
										<tr>
											<td><%= data[i].topic_id%></td>
											<td><%= data[i].distance%></td>
											<td><%= data[i].dt%></td>
										</tr>
										<% } %>
								</tbody>
							</table>
							<script src="/socket.io/socket.io.js"></script>
							<script>
								var socket = io.connect('http://34.87.68.246', {transports: ['websocket']});
socket.on('connect', function(){
	console.log("Socket connected to server");
	socket.on('message', function(msg) {
		console.log(msg);
		// To be implemented for auto update of webpage w/o refreshing.
		//$("#data2").append('<tr>');
		//$("#data2").append('<td>'.concat(msg.payload['data'].topic_id ,'</td>'));
		//$("#data2").append('<td>'.concat(msg.payload['distance'] ,'</td>'));
		//$("#data2").append('<td>'.concat(msg.payload['data'],'</td>'));
		//$("#data2").append('</tr>');
		location.reload();
	});
});
							</script>
						</div>
						<% include partials/footer.ejs %>
					</div>
					<script src="/javascripts/label_template.js"></script>
	</body>
</html>
